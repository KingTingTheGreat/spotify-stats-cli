THIS IS VERY POORLY WRITTEN. PLEASE DON'T USE UNTIL I REFACTOR
